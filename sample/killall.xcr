#use base qw(limit core);
use base qw(core);

#$limit::smph=Thread::Semaphore->new(3);

%xyz = (
    'id' => 'job6',
    'exe' => 'echo',
    'queue' => 'gh10034',
    'option' => '# @$-g gh10034'
);

my @jobs = &prepare(%xyz, 'arg0S' => [0..9],
 'after' => 'if ($self->{stdout} == 2) { system("qdel -u $ENV{USERNAME}"); }'
);
my @thrds = &submit(@jobs);
my @results  = &sync(@thrds);
foreach (@results) { print $_->{stdout}; }
